<?phpclass ControllerPrilSaveCountTaskl extends Controller {	public function index() {		require_once 'function.php';				$this->load->model('pril/allow');			$Login = "test";		$ID = "90193ad67094669e38fb7f37b40684cdb839e1c7";		$fcmToken = 'token';			foreach (object_to_array(retrieveJsonPostData()) as $pril_key => $pril_value) {			switch ($pril_key) {				case 'Login':					$Login = $pril_value;					break;				case 'ID':					$ID = $pril_value;					break;				case 'Token':					$fcmToken = $pril_value;					break;			}		}		$Yes = false;		if($Login != '' && $ID != ''){			if(!$Yes){				$server = $this->model_pril_allow->getCustomerId($Login, $ID);				$customerId = $server[0]['customer_id'];				$server = $this->model_pril_allow->getCompanyUser($customerId);				$customerInfo = $server[0]['custom_field'];				$Data = json_decode($customerInfo, true);				define('APIKEY_USERSIDE', $Data[1]);				define('USERSIDE', $Data[2]);				define('STATEID', $Data[3]);				$Yes = true;			}			if($Yes){				$getOperatorId = array(					'key'    => APIKEY_USERSIDE,					'cat'    => 'operator',					'action' => 'get_id_by_login',					'login'  => $Login,				);				$userside_OperatorId = object_to_array(json_decode(create_ticket($getOperatorId, USERSIDE)));				$getOperatorData = array(						'key'    => APIKEY_USERSIDE,						'cat'    => 'operator',						'action' => 'get',						'id'  	 => $userside_OperatorId['id'],				);				$userside_OperatorData = object_to_array(json_decode(create_ticket($getOperatorData, USERSIDE)));				$getStaffId = array(					'key'    	 => APIKEY_USERSIDE,					'cat'    	 => 'staff',					'action' 	 => 'get_staff_id',					'data_typer' => 'name',					'data_value' => $userside_OperatorData['data'][$userside_OperatorId['id']]['name'],				);				$userside_StaffId = object_to_array(json_decode(create_ticket($getStaffId, USERSIDE)));				$StaffTasks = array(						'key'      		=> APIKEY_USERSIDE,						'cat'      		=> 'task',						'subcat'   		=> 'get_list',						'state_id' 		=> STATEID,						'date_do_from'	=> date("Y-m-d"),						'date_do_to'	=> date("Y-m-d"),						'staff_id' 		=> $userside_StaffId['id'],				);				$userside_StaffTasks = object_to_array(json_decode(create_ticket($StaffTasks, USERSIDE)));				$TaskCount = $userside_StaffTasks['count'];// Кол-во тасков, записанных в юзерсайде				//if($Login != "test"){					$server = $this->model_pril_allow->getTypeId($ID, $Login, $fcmToken);					$taskTypeId = $server[0]['group_id'];					if($taskTypeId == 0){						$server = $this->model_pril_allow->updateBD("count_task", $TaskCount, "Login_us", $Login."' AND customer_id = '".$customerId."' AND group_id = '".$taskTypeId);						print_r("Кол-во тасков изменено их = ".$TaskCount." Логин = ".$Login);					}else{						$server = $this->model_pril_allow->updateBD("count_task", $TaskCount, "Login_us", $Login."' AND customer_id = '".$customerId."' AND group_id = '".$taskTypeId);						print_r("Кол-во тасков изменено их = ".$TaskCount." Логин = ".$Login);					}				//}			}else{				//print_r("Не удалось получить данные вашего юзерсайда");			}		}else{			//print_r("Не отправлен логин");		}	}}